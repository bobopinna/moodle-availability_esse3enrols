YUI.add("moodle-availability_esse3enrols-form",function(i,e){M.availability_esse3enrols=M.availability_esse3enrols||{},M.availability_esse3enrols.form=i.Object(M.core_availability.plugin),M.availability_esse3enrols.form.initInner=function(e,s){this.idColumn=e.toLowerCase(),this.idNumberString=s.toLowerCase()},M.availability_esse3enrols.form.getNode=function(e){var t,r,o,s="";return e.creating===undefined&&e.idnumbers!==undefined&&(s=e.idnumbers),e='<label class="form-group"><span class="p-r-1">'+M.util.get_string("title","availability_esse3enrols")+"</span>",e+='<span class="availability-esse3enrols">',""==s&&(e+='<input class="esse3enrols-file" name="esse3enrolsfile" type="file" />'),e=(e+='<input class="esse3enrols-list-field" name="idnumbers" type="hidden" value="'+s+'" />')+('<span class="esse3enrols-list">'+s.split(",").join("<br />")+"</span>"),s=i.Node.create('<span class="form-inline">'+(e+="</span></label>")+"</span>"),t=M.util.get_string("missing","availability_esse3enrols"),M.availability_esse3enrols.form.addedEvents||(M.availability_esse3enrols.form.addedEvents=!0,e=i.one(".availability-field"),r=this.idColumn,o=this.idNumberString,e.delegate("change",function(){var e,s,i,l,a;0<this._node.files.length&&(e=this._node.files[0],i=(s=this).next(".esse3enrols-list-field"),l=this.next(".esse3enrols-list"),e&&((a=new FileReader).onload=function(e){var e=e.target.result,a=XLSX.read(e,{type:"binary"}),n=[];a.SheetNames.forEach(function(e){var s,i,e=XLSX.utils.sheet_to_row_object_array(a.Sheets[e]);if(e[0].hasOwnProperty("GRUPPO_GIUD_COD"))e.forEach(function(e){var s=parseInt(e.GRUPPO_GIUD_COD);e.hasOwnProperty("SUBSET")&&0<=s&&e.SUBSET.toLowerCase()!=r&&n.push(e.SUBSET)});else{for(i in s=null,e[0])i.toLowerCase()!=r&&i.toLowerCase()!=o||(s=i);null!=s&&e.forEach(function(e){e.hasOwnProperty(s)&&""!=e[s]&&n.push(e[s])})}}),0<n.length?(s.remove(),i.set("value",n.join(",")),l.set("innerHTML",n.join("<br />")),M.core_availability.form.update()):l.set("innerHTML",'<div class="invalid-feedback" style="display:block;">'+t+"</div>")},a.readAsBinaryString(e)))},".availability_esse3enrols input.esse3enrols-file")),s},M.availability_esse3enrols.form.focusAfterAdd=function(e){e.one("input:not([disabled])").focus()},M.availability_esse3enrols.form.fillValue=function(e,s){s=s.one("input[name=idnumbers]").get("value");e.idnumbers=""===s?"":s},M.availability_esse3enrols.form.fillErrors=function(e,s){""===s.one("input[name=idnumbers]").get("value")&&e.push("availability_esse3enrols:missing")}},"@VERSION@",{requires:["base","node","event","node-event-simulate","moodle-core_availability-form"]});