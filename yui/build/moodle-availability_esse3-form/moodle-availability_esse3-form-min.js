YUI.add("moodle-availability_esse3-form",function(a,e){M.availability_esse3=M.availability_esse3||{},M.availability_esse3.form=a.Object(M.core_availability.plugin),M.availability_esse3.form.initInner=function(){},M.availability_esse3.form.getNode=function(e){var n,i="";return e.creating===undefined&&e.idnumbers!==undefined&&(i=e.idnumbers),e='<label class="form-group"><span class="p-r-1">'+M.util.get_string("title","availability_esse3")+"</span>",e+='<span class="availability-esse3">',""==i&&(e+='<input class="esse3-file" name="esse3file" type="file" />'),e=(e+='<input class="esse3-list-field" name="idnumbers" type="hidden" value="'+i+'" />')+('<span class="esse3-list">'+i.split(",").join("<br />")+"</span>"),i=a.Node.create('<span class="form-inline">'+(e+="</span></label>")+"</span>"),n=M.util.get_string("missing","availability_esse3"),M.availability_esse3.form.addedEvents||(M.availability_esse3.form.addedEvents=!0,a.one(".availability-field").delegate("change",function(){var e,a,t,l,i;0<this._node.files.length&&(e=this._node.files[0],t=(a=this).next(".esse3-list-field"),l=this.next(".esse3-list"),e&&((i=new FileReader).onload=function(e){var e=e.target.result,i=XLSX.read(e,{type:"binary"}),s=[];i.SheetNames.forEach(function(e){var e=XLSX.utils.sheet_to_row_object_array(i.Sheets[e]),a="matricola".toLowerCase();e[0].hasOwnProperty("GRUPPO_GIUD_COD")&&e.forEach(function(e){var i=parseInt(e.GRUPPO_GIUD_COD);e.hasOwnProperty("SUBSET")&&0<=i&&e.SUBSET.toLowerCase()!=a&&s.push(e.SUBSET)})}),0<s.length?(a.remove(),t.set("value",s.join(",")),l.set("innerHTML",s.join("<br />")),M.core_availability.form.update()):l.set("innerHTML",'<div class="invalid-feedback" style="display:block;">'+n+"</div>")},i.readAsBinaryString(e)))},".availability_esse3 input.esse3-file")),i},M.availability_esse3.form.focusAfterAdd=function(e){e.one("input:not([disabled])").focus()},M.availability_esse3.form.fillValue=function(e,i){i=i.one("input[name=idnumbers]").get("value");e.idnumbers=""===i?"":i},M.availability_esse3.form.fillErrors=function(e,i){""===i.one("input[name=idnumbers]").get("value")&&e.push("availability_esse3:missing")}},"@VERSION@",{requires:["base","node","event","node-event-simulate","moodle-core_availability-form"]});